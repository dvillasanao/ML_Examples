---
title: "Entorno en R"
author: "Diana Villasana Ocampo"
output:
   html_document:
      code_folding: hide
      highlight: tango
      theme: flatly
      toc: true
      toc_depth: 3
      toc_float:
        collapsed: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, eval = FALSE,
                      cache.lazy = FALSE, class.source = "fold-show")
knitr::opts_knit$set(root.dir = here::here())
setwd(here::here())
```

```{r,echo=FALSE, eval=FALSE, }
rm(list = ls())
```

Crear un entorno en R con `renv` permite **aislar las dependencias de tu proyecto** para que sea **reproducible**, portable y menos propenso a errores por cambios en versiones de paquetes. A continuaciÃ³n se explica,  **todo lo esencial de usar `renv` correctamente**:


`renv` es un paquete de `R` que:

* Administra entornos de paquetes a nivel de proyecto.
* Guarda la versiÃ³n exacta de cada paquete usado.
* Permite compartir proyectos con otros sin conflictos de versiones.
* Crea un "lockfile" (`renv.lock`) que documenta las dependencias exactas.


### ğŸ”§ Requisitos previos

* Tener `R` instalado.
* Instalar el paquete `renv`:

```{r}
install.packages("renv")
```


### ğŸ§ª 1. Inicializar un entorno con `renv`

Desde la consola de `R` o `RStudio`, en la carpeta del proyecto:

```{r}
renv::init()
```

Esto hace:

* Crea un subdirectorio `renv/` con la librerÃ­a del proyecto.
* Genera `renv.lock` (archivo de bloqueo con las versiones de los paquetes).
* Crea o modifica `.Rprofile` para que cargue `renv` al abrir el proyecto.

ğŸ” Si tu proyecto ya tiene paquetes instalados, `renv` los detectarÃ¡ e incluirÃ¡.


### ğŸ“¦ 2. Instalar paquetes dentro del entorno

```{r}
install.packages("dplyr")  # o cualquier paquete
```

âœ… `renv` instalarÃ¡ el paquete dentro de la carpeta local del proyecto (`renv/library/`), no en  la instalaciÃ³n global de R.


### ğŸ“Œ 3. Registrar dependencias en el lockfile

Cuando se instalan nuevos paquetes, se pueden registrar los cambios en el lockfile:

```{r}
renv::snapshot()
```

Esto actualiza `renv.lock` para reflejar las nuevas dependencias.


### â™»ï¸ 4. Restaurar un entorno existente

Cuando se comparte el  proyecto con alguien (o se pasa a otro equipo), las personas pueden recrear el entorno exacto con:

```{r}
renv::restore()
```

Se usarÃ¡ `renv.lock` para instalar las versiones exactas de todos los paquetes.


### ğŸ” 5. ComprobaciÃ³n y limpieza

* Ver paquetes instalados:

```{r}
renv::status()
```

* Eliminar los paquetes que ya no se usan:

```{r}
renv::clean()
```

* Ver los paquetes usados en el proyecto:

```{r}
renv::dependencies()
```


### ğŸ“ Estructura tÃ­pica de un proyecto con `renv`

```
mi_proyecto/
â”œâ”€â”€ renv/              # LibrerÃ­a local y archivos internos de renv
â”œâ”€â”€ renv.lock          # Lista de paquetes y versiones
â”œâ”€â”€ .Rprofile          # Carga automÃ¡tica de renv al abrir el proyecto
â”œâ”€â”€ script.R           # Tu cÃ³digo en R
â””â”€â”€ ...                # Otros archivos del proyecto
```



### ğŸ’¡ Buenas prÃ¡cticas

* Usa `renv::snapshot()` cada vez que se cambien los paquetes.
* No editar `renv.lock` a mano.
* AÃ±adir `renv/` a `.gitignore`, pero **sÃ­** se incluye `renv.lock` y `.Rprofile` en el repositorio.
* Usa `renv::activate()` si necesitas reactivar el entorno (p. ej., despuÃ©s de mover el proyecto).



### ğŸ§³ Exportar/Compartir el entorno

* Comparte solo los archivos necesarios:

  * CÃ³digo (`*.R`, `*.Rmd`)
  * `renv.lock`
  * `.Rprofile`

Quien reciba el proyecto podrÃ¡ usar `renv::restore()` para recrear el entorno.


Si se desea  **quitar `renv` de un proyecto**, se puede hacer de forma segura, y hay varias opciones segÃºn quÃ© tanto se quiera eliminar:


### ğŸ§¼ OpciÃ³n 1: Desactivar `renv` sin borrar paquetes (mÃ¡s segura)

```{r}
renv::deactivate()
```

Esto harÃ¡ que el entorno de `renv` **deje de activarse automÃ¡ticamente**, pero **los paquetes instalados siguen ahÃ­**. Ãštil si solo quieres pausar `renv`.



### ğŸ—‘ï¸ OpciÃ³n 2: Eliminar por completo `renv` del proyecto

```{r}
renv::uninstall()
```

Este comando:

* Borra el directorio `renv/` (la biblioteca local y metadatos).
* Elimina `.Rprofile` o la parte que activa `renv`.
* Borra `renv.lock`.

âš ï¸ **Advertencia**: esto no desinstala los paquetes globales ni afecta otros proyectos.



### ğŸ§¹ Limpieza manual (si prefieres hacerlo por cuenta propia)

1. **Borrar estos archivos/directorios en el proyecto**:

   * `renv/`
   * `renv.lock`
   * `.Rprofile` (o edita este archivo para eliminar la lÃ­nea que carga `renv`)

2. **(Opcional)**: Eliminar los paquetes locales del disco si se quiere liberar espacio (lo harÃ­a `renv::uninstall()` tambiÃ©n).



### ğŸ” Â¿Y si luego quiero volver a usarlo?

Se puede volver a activarlo con:

```{r}
renv::init()
```


### ğŸ“ RecomendaciÃ³n

Antes de eliminar `renv`, se puede hacer una copia de seguridad de `renv.lock` si en algÃºn momento se quiere restaurar el entorno tal como estaba.



