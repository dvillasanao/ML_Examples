<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Diana Villasana Ocampo">

<title>Ordinary Least Squares Regression (OLSR)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="01_01_OLSR_py_files/libs/clipboard/clipboard.min.js"></script>
<script src="01_01_OLSR_py_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="01_01_OLSR_py_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="01_01_OLSR_py_files/libs/quarto-html/popper.min.js"></script>
<script src="01_01_OLSR_py_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="01_01_OLSR_py_files/libs/quarto-html/anchor.min.js"></script>
<link href="01_01_OLSR_py_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="01_01_OLSR_py_files/libs/quarto-html/quarto-syntax-highlighting-af5ec82acda093b5ee751184164e9432.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="01_01_OLSR_py_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="01_01_OLSR_py_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="01_01_OLSR_py_files/libs/bootstrap/bootstrap-7714f832e6fc2622986168d4fba84f88.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#objetivo" id="toc-objetivo" class="nav-link active" data-scroll-target="#objetivo">Objetivo</a></li>
  <li><a href="#metodología" id="toc-metodología" class="nav-link" data-scroll-target="#metodología">Metodología</a></li>
  <li><a href="#pasos-generales-del-machine-learning-supervisado" id="toc-pasos-generales-del-machine-learning-supervisado" class="nav-link" data-scroll-target="#pasos-generales-del-machine-learning-supervisado"><strong>Pasos generales del Machine Learning supervisado</strong></a></li>
  <li><a href="#base-de-datos" id="toc-base-de-datos" class="nav-link" data-scroll-target="#base-de-datos">Base de datos</a></li>
  <li><a href="#entrenamiento-de-los-datos-traintest" id="toc-entrenamiento-de-los-datos-traintest" class="nav-link" data-scroll-target="#entrenamiento-de-los-datos-traintest">Entrenamiento de los datos (train/test)</a></li>
  <li><a href="#entrenamiento-del-modelo" id="toc-entrenamiento-del-modelo" class="nav-link" data-scroll-target="#entrenamiento-del-modelo">Entrenamiento del modelo</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Ordinary Least Squares Regression (OLSR)</h1>
<p class="subtitle lead">Apuntes y anotaciones personales</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Diana Villasana Ocampo </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<style type="text/css">
body {
text-align: justify;
font-style: normal;
font-family: "Montserrat";
font-size: 12px
}
h1.title {
  font-size: 40px;
  color: #000D3B;
}
h1 {
  font-size: 35px;
  color: #B6854D;
}
h2 {
  font-size: 30px;
  color: #172984;
}
h3 {
  font-size: 25px;
  color: #172984;
}
h4 {
  font-size: 22px;
  color: #172984;
}
h5 {
  ont-size: 20px;
  color: #172984;
}
h6{
  ont-size: 18px;
  color: #1864cb;
}
</style>
<style>
.nav>li>a {
    position: relative;
    display: block;
    padding: 10px 15px;
    color: #1C3BA4
}
.nav-pills>li.active>a, .nav-pills>li.active>a:hover, .nav-pills>li>a:focus {
    color: #ffffff;
    background-color: #09C2BC
}
</style>
<style>
.tile1-text {
    position: relative;
    display: block;
    padding: 10px 15px;
    color: #0A6A87;
    list-style: none;
}
.top1-tiles a:nth-of-type(1):hover, .top-tiles1 a:nth-of-type(1):focus{
    color: #ffffff;
    background: #0A6A87
}
</style>
<style>
.tile2-text {
    position: relative;
    display: block;
    padding: 10px 15px;
    color: #0A6CC8;
    list-style: none;
}
.top2-tiles a:nth-of-type(1):hover, .top2-tiles a:nth-of-type(1):focus{
    color: #ffffff;
    background: #0A6CC8
}
</style>
<style>
.math {
  font-size: 15px;
  color: #1e42ab;
}

.callout {
  border: 1px solid red; /* Yellow border */
  background-color: lightgrey; /* Light yellow background */
  padding: 15px;
  margin-bottom: 15px;
  border-left: 5px solid #ffcc00; /* Stronger left border */
}

</style>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Este material es reproducible en código Python utilizando Quarto
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p>La Regresión por Mínimos Cuadrados Ordinarios (Ordinary Least Squares Regression, <strong>OLSR</strong> u <strong>OLS</strong>) representa una metodología estadística esencial que permite analizar la correlación entre una <strong>variable dependiente</strong> (también conocida como variable de respuesta) y una o más <strong>variables independientes</strong> (o predictoras). Este método constituye una herramienta fundamental en el campo del análisis de regresión lineal.</p>
<p align="center">
<img src="../../img/Regression/01_image_OLSR.png" alt="Machine Learning Steps" width="40%">
</p>
<p><strong>Librerías que se usaron en el documento</strong></p>
<div id="load-py-pckgs" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rpy2</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os <span class="co"># Necesario para la función os.makedirs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4c665cc1" class="cell" data-execution_count="5">
<div class="cell-output cell-output-display" data-execution_count="10">
<style type="text/css">
#T_672b7 td {
  padding: 1px;
}
#T_672b7_row0_col0, #T_672b7_row0_col1, #T_672b7_row1_col0, #T_672b7_row1_col1, #T_672b7_row2_col0, #T_672b7_row2_col1, #T_672b7_row3_col0, #T_672b7_row3_col1, #T_672b7_row4_col0, #T_672b7_row4_col1, #T_672b7_row5_col0, #T_672b7_row5_col1, #T_672b7_row6_col0, #T_672b7_row6_col1, #T_672b7_row7_col0, #T_672b7_row7_col1, #T_672b7_row8_col0, #T_672b7_row8_col1, #T_672b7_row9_col0, #T_672b7_row9_col1, #T_672b7_row10_col0, #T_672b7_row10_col1, #T_672b7_row11_col0, #T_672b7_row11_col1, #T_672b7_row12_col0, #T_672b7_row12_col1 {
  width: 200px;
  text-align: left;
}
#T_672b7_row0_col2, #T_672b7_row1_col2, #T_672b7_row2_col2, #T_672b7_row3_col2, #T_672b7_row4_col2, #T_672b7_row5_col2, #T_672b7_row6_col2, #T_672b7_row7_col2, #T_672b7_row8_col2, #T_672b7_row9_col2, #T_672b7_row10_col2, #T_672b7_row11_col2, #T_672b7_row12_col2 {
  width: 500px;
  text-align: left;
}
</style>

<div id="T_672b7" class="quarto-float quarto-figure quarto-figure-center anchored" style="font-family: Century Gothic; font-size: 10pt;" data-quarto-postprocess="true">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="T_672b7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Fuente: Elaboración propia
</figcaption>
<div aria-describedby="T_672b7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="T_672b7" class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_672b7_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Criterio</th>
<th id="T_672b7_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">Aplica</th>
<th id="T_672b7_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">Detalles</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_672b7_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_672b7_row0_col0" class="data row0 col0">🔍 Tipo de modelo</td>
<td id="T_672b7_row0_col1" class="data row0 col1">Supervisado</td>
<td id="T_672b7_row0_col2" class="data row0 col2">Se entrena con datos X → y</td>
</tr>
<tr class="even">
<td id="T_672b7_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_672b7_row1_col0" class="data row1 col0">🎯 Variable respuesta</td>
<td id="T_672b7_row1_col1" class="data row1 col1">Numérica continua</td>
<td id="T_672b7_row1_col2" class="data row1 col2">Ej. mpg, precio, ingresos</td>
</tr>
<tr class="odd">
<td id="T_672b7_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_672b7_row2_col0" class="data row2 col0">🔢 Variables predictoras</td>
<td id="T_672b7_row2_col1" class="data row2 col1">Numéricas y/o categóricas</td>
<td id="T_672b7_row2_col2" class="data row2 col2">Categorías convertidas a dummies</td>
</tr>
<tr class="even">
<td id="T_672b7_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_672b7_row3_col0" class="data row3 col0">📈 Relación entre variables</td>
<td id="T_672b7_row3_col1" class="data row3 col1">Lineal (supuesto clave)</td>
<td id="T_672b7_row3_col2" class="data row3 col2">Se asume una relación lineal entre X e Y</td>
</tr>
<tr class="odd">
<td id="T_672b7_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">4</td>
<td id="T_672b7_row4_col0" class="data row4 col0">🧪 Normalidad de residuos</td>
<td id="T_672b7_row4_col1" class="data row4 col1">Deseable</td>
<td id="T_672b7_row4_col2" class="data row4 col2">Importante para intervalos de confianza válidos</td>
</tr>
<tr class="even">
<td id="T_672b7_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">5</td>
<td id="T_672b7_row5_col0" class="data row5 col0">🔁 Independencia de errores</td>
<td id="T_672b7_row5_col1" class="data row5 col1">Necesaria</td>
<td id="T_672b7_row5_col2" class="data row5 col2">Errores deben ser independientes</td>
</tr>
<tr class="odd">
<td id="T_672b7_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">6</td>
<td id="T_672b7_row6_col0" class="data row6 col0">⚖️ Homoscedasticidad</td>
<td id="T_672b7_row6_col1" class="data row6 col1">Necesaria</td>
<td id="T_672b7_row6_col2" class="data row6 col2">Varianza de errores debe ser constante</td>
</tr>
<tr class="even">
<td id="T_672b7_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">7</td>
<td id="T_672b7_row7_col0" class="data row7 col0">❗ Sensible a outliers</td>
<td id="T_672b7_row7_col1" class="data row7 col1">Sí</td>
<td id="T_672b7_row7_col2" class="data row7 col2">Outliers pueden influir mucho en el modelo</td>
</tr>
<tr class="odd">
<td id="T_672b7_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">8</td>
<td id="T_672b7_row8_col0" class="data row8 col0">🔗 Multicolinealidad entre predictores</td>
<td id="T_672b7_row8_col1" class="data row8 col1">Problema común</td>
<td id="T_672b7_row8_col2" class="data row8 col2">Usar VIF para detectar problemas</td>
</tr>
<tr class="even">
<td id="T_672b7_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">9</td>
<td id="T_672b7_row9_col0" class="data row9 col0">🧠 Interpretabilidad</td>
<td id="T_672b7_row9_col1" class="data row9 col1">Alta</td>
<td id="T_672b7_row9_col2" class="data row9 col2">Modelo fácil de explicar</td>
</tr>
<tr class="odd">
<td id="T_672b7_level0_row10" class="row_heading level0 row10" data-quarto-table-cell-role="th">10</td>
<td id="T_672b7_row10_col0" class="data row10 col0">🚀 Velocidad y eficiencia</td>
<td id="T_672b7_row10_col1" class="data row10 col1">Muy alta</td>
<td id="T_672b7_row10_col2" class="data row10 col2">Rápido incluso con datos grandes</td>
</tr>
<tr class="even">
<td id="T_672b7_level0_row11" class="row_heading level0 row11" data-quarto-table-cell-role="th">11</td>
<td id="T_672b7_row11_col0" class="data row11 col0">🧪 Validación cruzada</td>
<td id="T_672b7_row11_col1" class="data row11 col1">Compatible</td>
<td id="T_672b7_row11_col2" class="data row11 col2">Ayuda a prevenir overfitting</td>
</tr>
<tr class="odd">
<td id="T_672b7_level0_row12" class="row_heading level0 row12" data-quarto-table-cell-role="th">12</td>
<td id="T_672b7_row12_col0" class="data row12 col0">❌ No funciona bien si...</td>
<td id="T_672b7_row12_col1" class="data row12 col1">Relaciones no lineales, outliers severos, colinealidad</td>
<td id="T_672b7_row12_col2" class="data row12 col2">Evitar si no hay linealidad o hay muchos outliers</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
<section id="objetivo" class="level2">
<h2 class="anchored" data-anchor-id="objetivo">Objetivo</h2>
<p>La Regresión por Mínimos Cuadrados Ordinarios (<code>OLSR</code>) busca la línea que mejor se ajusta a los datos. Para lograrlo, reduce al mínimo la suma de los cuadrados de las diferencias entre los valores reales y los valores que predice el modelo. Estas diferencias son los <strong>residuos</strong> o <strong>errores</strong>. Al trabajar con los cuadrados de los errores, este método evita que los errores positivos y negativos se anulen entre sí, y da más peso a los errores grandes durante el proceso de minimización.</p>
</section>
<section id="metodología" class="level2">
<h2 class="anchored" data-anchor-id="metodología">Metodología</h2>
<p>La metodología de OLSR se basa en los siguientes pasos y principios:</p>
<ol type="1">
<li><p><strong>Modelo Lineal:</strong> OLSR asume una relación lineal entre las variables. Para una regresión lineal simple (una variable independiente), la ecuación es:<br>
<span class="math display">\[Y = \beta_0 + \beta_1X + \epsilon\]</span></p>
<p>Donde:</p>
<ul>
<li><span class="math inline">\(Y\)</span> es la variable dependiente.</li>
</ul></li>
</ol>
<ul>
<li><span class="math inline">\(X\)</span> es la variable independiente.</li>
<li><span class="math inline">\(\beta_0\)</span> es el intercepto (el valor de <span class="math inline">\(Y\)</span> cuando <span class="math inline">\(X\)</span> es 0).</li>
<li><span class="math inline">\(\beta_1\)</span> es la pendiente (el cambio en <span class="math inline">\(Y\)</span> por cada unidad de cambio en <span class="math inline">\(X\)</span>).</li>
<li><span class="math inline">\(\epsilon\)</span> es el término de error o residual, que representa la parte de <span class="math inline">\(Y\)</span> que no puede ser explicada por <span class="math inline">\(X\)</span>.</li>
</ul>
<p>Para una regresión lineal múltiple (varias variables independientes), la ecuación se expande a:<br>
<span class="math display">\[Y = \beta_0 + \beta_1X_1 + \beta_2X_2 + ... + \beta_kX_k + \epsilon\]</span></p>
<ol start="2" type="1">
<li><strong>Minimización de la Suma de Cuadrados de Residuos (SSR):</strong> El corazón de OLS es encontrar los valores de los coeficientes (<span class="math inline">\(\beta_0, \beta_1\)</span>, etc.) que minimicen la siguiente función:<br>
<span class="math display">\[\text{Minimizar } \sum_{i=1}^{n} (y_i - \hat{y}_i)^2\]</span><br>
Donde:
<ul>
<li><span class="math inline">\(y_i\)</span> es el valor observado de la variable dependiente para la observación <span class="math inline">\(i\)</span>.</li>
</ul></li>
</ol>
<ul>
<li><span class="math inline">\(\hat{y}_i\)</span> es el valor predicho de la variable dependiente por el modelo para la observación <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\((y_i - \hat{y}_i)\)</span> es el residual para la observación <span class="math inline">\(i\)</span>.</li>
</ul>
<p>Para lograr esta minimización, se utilizan técnicas de cálculo (derivadas parciales) para encontrar los valores de los coeficientes que hacen que la pendiente de la función de suma de cuadrados sea cero.</p>
<ol start="3" type="1">
<li><p><strong>Estimación de Coeficientes:</strong> Los valores estimados de los coeficientes, denotados como <span class="math inline">\(\hat{\beta}_0, \hat{\beta}_1\)</span>, etc., son aquellos que resultan de la minimización. Estos coeficientes son los que definen la “línea de mejor ajuste”.</p></li>
<li><p><strong>Supuestos del OLS:</strong> Para que los estimadores de OLS sean los “mejores estimadores lineales insesgados” (según el Teorema de Gauss-Markov), se deben cumplir ciertas suposiciones:</p>
<ul>
<li><p><strong>Linealidad:</strong> La relación entre las variables es lineal.</p></li>
<li><p><strong>Independencia de los errores:</strong> Los errores de una observación no están correlacionados con los errores de otra.</p></li>
<li><p><strong>Homocedasticidad:</strong> La varianza de los errores es constante en todos los niveles de las variables independientes.</p></li>
<li><p><strong>Normalidad de los errores:</strong> Los errores se distribuyen normalmente (aunque no es estrictamente necesario para la estimación, sí lo es para la inferencia estadística).</p></li>
<li><p><strong>No multicolinealidad perfecta:</strong> Las variables independientes no están perfectamente correlacionadas entre sí.</p></li>
</ul></li>
</ol>
</section>
<section id="pasos-generales-del-machine-learning-supervisado" class="level2">
<h2 class="anchored" data-anchor-id="pasos-generales-del-machine-learning-supervisado"><strong>Pasos generales del Machine Learning supervisado</strong></h2>
<ol type="1">
<li><strong>Importar y explorar los datos</strong></li>
<li><strong>Preprocesamiento</strong></li>
<li><strong>División de los datos (train/test)</strong></li>
<li><strong>Entrenamiento del modelo</strong></li>
<li><strong>Evaluación del modelo</strong></li>
<li><strong>Ajustes o validación cruzada (si aplica)</strong></li>
<li><strong>Predicción con nuevos datos</strong></li>
<li><strong>Interpretación de resultados</strong></li>
</ol>
<p align="center">
<img src="../../img/ML_Steps.png" alt="Machine Learning Steps" width="100%">
</p>
<hr>
</section>
<section id="base-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="base-de-datos">Base de datos</h2>
<p>La base de datos <code>mtcars</code> es un conjunto de datos clásico en R que contiene información sobre <strong>32 automóviles</strong> (modelos de 1973–74), y fue extraído de la revista <em>Motor Trend US</em>. Incluye <strong>variables técnicas</strong> del desempeño de los autos.</p>
<p>Aquí está una descripción de cada columna:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 47%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Significado</th>
<th>Tipo de dato</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>mpg</code></td>
<td>Miles per gallon (millas por galón)</td>
<td>Numérica</td>
</tr>
<tr class="even">
<td><code>cyl</code></td>
<td>Número de cilindros</td>
<td>Entero</td>
</tr>
<tr class="odd">
<td><code>disp</code></td>
<td>Desplazamiento del motor (en pulgadas cúbicas)</td>
<td>Numérica</td>
</tr>
<tr class="even">
<td><code>hp</code></td>
<td>Caballos de fuerza</td>
<td>Entero</td>
</tr>
<tr class="odd">
<td><code>drat</code></td>
<td>Relación del eje trasero (rear axle ratio)</td>
<td>Numérica</td>
</tr>
<tr class="even">
<td><code>wt</code></td>
<td>Peso del auto (en miles de libras)</td>
<td>Numérica</td>
</tr>
<tr class="odd">
<td><code>qsec</code></td>
<td>Tiempo en 1/4 de milla (segundos)</td>
<td>Numérica</td>
</tr>
<tr class="even">
<td><code>vs</code></td>
<td>Tipo de motor: 0 = V-shaped, 1 = straight (en línea)</td>
<td>Binaria (factor)</td>
</tr>
<tr class="odd">
<td><code>am</code></td>
<td>Tipo de transmisión: 0 = automática, 1 = manual</td>
<td>Binaria (factor)</td>
</tr>
<tr class="even">
<td><code>gear</code></td>
<td>Número de velocidades (marchas) adelante</td>
<td>Entero</td>
</tr>
<tr class="odd">
<td><code>carb</code></td>
<td>Número de carburadores</td>
<td>Entero</td>
</tr>
</tbody>
</table>
<div id="768724d0" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>require(reticulate)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>reticulate::repl_python() <span class="co">#can be used to interactively run Python code</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Cargar y se exploran los datos</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>data(<span class="st">"mtcars"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cfcbefde" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pip install openpyxl </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os <span class="co"># Necesario para la función os.makedirs</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar la base de datos mtcars directamente desde el entorno de R</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># r.mtcars accede al objeto 'mtcars' que R ha puesto a disposición</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Reticulate automáticamente lo convierte a un DataFrame de Pandas.</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>mtcars_df <span class="op">=</span> r.mtcars</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">## Se guarda la base de datos en un archivo Excel  </span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span> <span class="op">=</span> Path.cwd().parent.parent <span class="op">/</span> <span class="st">"Data"</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>mtcars_df.to_excel(<span class="bu">file</span> <span class="op">/</span><span class="st">"mtcars_data.xlsx"</span>, index<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="680ccf02" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mtcars_df <span class="op">=</span> pd.read_excel(Path.cwd().parent.parent <span class="op">/</span> <span class="st">"Data"</span> <span class="op">/</span> <span class="st">"mtcars_data.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="5a00bfdf" class="cell" data-execution_count="9">
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Unnamed: 0</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Mazda RX4</td>
<td>21.0</td>
<td>6</td>
<td>160.0</td>
<td>110</td>
<td>3.90</td>
<td>2.620</td>
<td>16.46</td>
<td>0</td>
<td>1</td>
<td>4</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Mazda RX4 Wag</td>
<td>21.0</td>
<td>6</td>
<td>160.0</td>
<td>110</td>
<td>3.90</td>
<td>2.875</td>
<td>17.02</td>
<td>0</td>
<td>1</td>
<td>4</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Datsun 710</td>
<td>22.8</td>
<td>4</td>
<td>108.0</td>
<td>93</td>
<td>3.85</td>
<td>2.320</td>
<td>18.61</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Hornet 4 Drive</td>
<td>21.4</td>
<td>6</td>
<td>258.0</td>
<td>110</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1</td>
<td>0</td>
<td>3</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Hornet Sportabout</td>
<td>18.7</td>
<td>8</td>
<td>360.0</td>
<td>175</td>
<td>3.15</td>
<td>3.440</td>
<td>17.02</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Valiant</td>
<td>18.1</td>
<td>6</td>
<td>225.0</td>
<td>105</td>
<td>2.76</td>
<td>3.460</td>
<td>20.22</td>
<td>1</td>
<td>0</td>
<td>3</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Duster 360</td>
<td>14.3</td>
<td>8</td>
<td>360.0</td>
<td>245</td>
<td>3.21</td>
<td>3.570</td>
<td>15.84</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Merc 240D</td>
<td>24.4</td>
<td>4</td>
<td>146.7</td>
<td>62</td>
<td>3.69</td>
<td>3.190</td>
<td>20.00</td>
<td>1</td>
<td>0</td>
<td>4</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Merc 230</td>
<td>22.8</td>
<td>4</td>
<td>140.8</td>
<td>95</td>
<td>3.92</td>
<td>3.150</td>
<td>22.90</td>
<td>1</td>
<td>0</td>
<td>4</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Merc 280</td>
<td>19.2</td>
<td>6</td>
<td>167.6</td>
<td>123</td>
<td>3.92</td>
<td>3.440</td>
<td>18.30</td>
<td>1</td>
<td>0</td>
<td>4</td>
<td>4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="entrenamiento-de-los-datos-traintest" class="level2">
<h2 class="anchored" data-anchor-id="entrenamiento-de-los-datos-traintest">Entrenamiento de los datos (train/test)</h2>
<p>La división de datos en conjuntos de <strong>entrenamiento (train)</strong> y <strong>prueba (test)</strong> es una práctica fundamental en el aprendizaje automático y la modelización predictiva. Su importancia radica en la necesidad de obtener una evaluación <strong>realista y no sesgada</strong> del rendimiento de un modelo, y de asegurar que el modelo sea capaz de <strong>generalizar</strong> a datos nuevos y no vistos.</p>
<ul>
<li>En Python, <code>train_test_split()</code> devuelve directamente los cuatro conjuntos de datos:
<ul>
<li><code>X_train</code>: Predictoras para entrenamiento.</li>
</ul></li>
<li><code>X_test</code>: Predictoras para prueba.</li>
<li><code>y_train</code>: Variable objetivo para entrenamiento.</li>
<li><code>y_test</code>: Variable objetivo para prueba.</li>
</ul>
<div id="split-data" class="cell" data-message="false" data-execution_count="10">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np <span class="co"># Necesario si necesitas setear una semilla para numpy/pandas</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir la variable objetivo (dependiente)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>target_variable <span class="op">=</span> <span class="st">'mpg'</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># X contendrá todas las variables predictoras (features)</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Y contendrá la variable objetivo</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> mtcars_df.drop(columns<span class="op">=</span>[target_variable])</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> mtcars_df[target_variable]</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Dividir los datos en entrenamiento y prueba</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># random_state es el equivalente a set.seed() para reproducibilidad</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># test_size=0.2 significa que el 20% de los datos irán al conjunto de prueba (80% para entrenamiento)</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Esto es importante para asegurar que las proporciones de 'mpg' sean similares en ambos conjuntos,</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># especialmente útil para variables categóricas o si la distribución de 'mpg' es importante.</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">123</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Tamaño del conjunto de entrenamiento (X_train): </span><span class="sc">{</span>X_train<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Tamaño del conjunto de prueba (X_test): </span><span class="sc">{</span>X_test<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Tamaño del conjunto de entrenamiento (y_train): </span><span class="sc">{</span>y_train<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Tamaño del conjunto de prueba (y_test): </span><span class="sc">{</span>y_test<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tamaño del conjunto de entrenamiento (X_train): (25, 11)
Tamaño del conjunto de prueba (X_test): (7, 11)
Tamaño del conjunto de entrenamiento (y_train): (25,)
Tamaño del conjunto de prueba (y_test): (7,)</code></pre>
</div>
</div>
<ul>
<li>Particionar los datos, evita el <strong>overfitting</strong> (cuando el modelo memoriza los datos de entrenamiento).</li>
<li>Permite una <strong>evaluación honesta</strong> del modelo al probarlo en datos que no vio durante el entrenamiento.</li>
<li>Es una práctica estándar en cualquier pipeline de aprendizaje automático.</li>
</ul>
</section>
<section id="entrenamiento-del-modelo" class="level2">
<h2 class="anchored" data-anchor-id="entrenamiento-del-modelo">Entrenamiento del modelo</h2>
<p>El <strong>entrenamiento de un modelo</strong> es el paso más importante en el aprendizaje automático. Usando un conjunto de datos de entrenamiento (<code>train_data</code>), el modelo aprende a reconocer patrones para hacer predicciones confiables con datos nuevos. Este proceso es esencial por estas razones:</p>
<ul>
<li>Durante el entrenamiento, el modelo <strong>identifica patrones específicos</strong> en los datos.</li>
<li>Separamos los datos en grupos de entrenamiento y prueba para asegurar que el modelo funcione bien no solo con datos conocidos, sino también con <strong>datos nuevos y no vistos</strong>.</li>
<li>Después del entrenamiento con <code>train_data</code>, usamos el <strong>conjunto de prueba (<code>test_data</code>)</strong> para medir el rendimiento. Las métricas (MAE, RMSE, <span class="math inline">\(R^2\)</span>) nos muestran qué tan bien el modelo <strong>maneja datos nuevos</strong>.</li>
<li>Un rendimiento peor en <code>test_data</code> que en <code>train_data</code> indica que el modelo está sobreajustado.</li>
<li>Con estos resultados, podemos decidir si el modelo está listo para usar o necesita ajustes.</li>
</ul>
<p><strong>Función de entrenamiento</strong></p>
<ul>
<li><code>modelo_ols_py = smf.ols(formula=formula, data=train_data_combined).fit()</code>:</li>
<li><code>smf.ols()</code>: Es la función para ajustar un modelo de Mínimos Cuadrados Ordinarios (Ordinary Least Squares - OLS).</li>
<li><code>formula=formula</code>: Le pasamos la cadena de fórmula que definimos.</li>
<li><code>data=train_data_combined</code>: Le indicamos de qué DataFrame debe tomar las variables.</li>
<li><code>.fit()</code>: Este método entrena el modelo sobre los datos.</li>
</ul>
<div id="train-ols-model" class="cell" data-message="false" data-results="as-is" data-execution_count="11">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf <span class="co"># Para la sintaxis tipo R de fórmulas</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Asumiendo que X_train, X_test, y_train, y_test ya están definidos</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># por el chunk de división de datos anterior.</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Para asegurar que X_train y y_train se combinen correctamente para statsmodels</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># statsmodels prefiere un solo DataFrame que contenga todas las variables</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Esto es similar a cómo `lm` en R usa `data = train_data`</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar X_train y y_train en un solo DataFrame para statsmodels</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>train_data_combined <span class="op">=</span> pd.concat([X_train, y_train], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir la fórmula del modelo (similar a R)</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># mpg ~ . significa "mpg en función de todas las demás variables en el DataFrame"</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Para statsmodels, es mejor listar explícitamente las columnas si X_train tiene muchas</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># O si quieres un subconjunto específico, lo especificas aquí.</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Aquí construimos la fórmula dinámicamente para incluir todas las variables de X_train</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>formula <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>y_train<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> ~ "</span> <span class="op">+</span> <span class="st">" + "</span>.join(X_train.columns)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Entrenar el modelo de regresión lineal (OLS)</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co"># statsmodels.formula.api permite usar la sintaxis de fórmula similar a R</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>modelo_ols_py <span class="op">=</span> smf.ols(formula<span class="op">=</span>formula, data<span class="op">=</span>train_data_combined).fit()</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Revisar resumen del modelo (similar a summary() en R)</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Resumen del Modelo OLS en Python:"</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(modelo_ols_py.summary()) <span class="co"># .as_html() para una salida bonita en Quarto</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Resumen del Modelo OLS en Python:
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                    mpg   R-squared:                       0.896
Model:                            OLS   Adj. R-squared:                  0.821
Method:                 Least Squares   F-statistic:                     12.00
Date:                Sun, 15 Jun 2025   Prob (F-statistic):           3.06e-05
Time:                        01:35:19   Log-Likelihood:                -52.439
No. Observations:                  25   AIC:                             126.9
Df Residuals:                      14   BIC:                             140.3
Df Model:                          10                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept    -19.2700     31.016     -0.621      0.544     -85.792      47.252
cyl            1.0972      1.593      0.689      0.502      -2.319       4.513
disp           0.0062      0.020      0.307      0.764      -0.037       0.049
hp            -0.0053      0.025     -0.212      0.835      -0.059       0.048
drat           1.8203      2.101      0.866      0.401      -2.687       6.327
wt            -3.6682      2.289     -1.603      0.131      -8.577       1.241
qsec           2.1398      1.379      1.552      0.143      -0.817       5.097
vs             0.8514      4.586      0.186      0.855      -8.985      10.688
am             5.8806      3.918      1.501      0.156      -2.523      14.285
gear          -1.0928      2.698     -0.405      0.692      -6.879       4.694
carb           0.0325      0.975      0.033      0.974      -2.060       2.125
==============================================================================
Omnibus:                        2.342   Durbin-Watson:                   1.335
Prob(Omnibus):                  0.310   Jarque-Bera (JB):                1.544
Skew:                           0.374   Prob(JB):                        0.462
Kurtosis:                       2.040   Cond. No.                     1.94e+04
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 1.94e+04. This might indicate that there are
strong multicollinearity or other numerical problems.</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>